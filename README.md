# seven

Course homework submission website.


## Installation

Follow the standard steps for setting up a Rails development environment.

```bash
git clone
bundle install
rake db:create db:migrate
```

Due to [a nasty crash](https://github.com/cowboyd/therubyracer/issues/317), the
embedded CoffeeScript compilation method is disabled, and the project needs
[node.js](https://nodejs.org/) installed.

```bash
sudo apt-get install -y nodejs
sudo yum install -y nodejs npm
```

The command below runs the development server. Ctrl+C stops it.

```bash
rails s
```

The first user registered on the system automatically receives administrative
privileges. Course specifics can be configured by selecting Setup > Course in
the left-side menu.


## Development

Seed the database to get a reasonably large data set that covers the most used
cases.

```bash
rake db:seed
```

Much of the CSS running this site is in the
[pwnstyles](https://github.com/pwnall/pwnstyles) Rails engine.  Follow the
steps below to change it.

1. clone the repository in a sibling directory to seven
1. look for pwnstyles in the Gemfile, un-comment the directive that has a `path:` option, and comment out the other directive (that uses a gem)
1. `bundle install` to update Gemfile.lock
1. `rake tmp:clear` to blow up the SCSS cache
1. restart your dev server

Refreshing the page should reflect any CSS changes that you make. If that
doesn't happen, touch
`app/assets/stylesheets/pwnstyles/pwnstyles_main.css.scss`

The comments at the top of the model files are automatically generated by the
[annotate_models](http://pragdave.pragprog.com/pragdave/2006/02/annotate_models.html)
plugin. Re-generate them using the following command.

```bash
bundle exec annotate
```


## Production Deployment on alg.csail.mit.edu

Back up the previous site version.

```bash
sudo rpwn backup
```

Update the OS layer.

```bash
sudo apt-get update && sudo apt-get -y dist-upgrade
sudo gem update --system
sudo gem update
```

Update the application code.

```bash
sudo rpwn update seven
```

Reset the database.

```bash
sudo rpwn dbreset seven
```
